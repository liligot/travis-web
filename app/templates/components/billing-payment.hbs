{{#travis-form onSubmit=(perform makeStripePayment) as |form|}}
  <div class="billing-form" data-billing-form>
    {{billing-select-plan
      selectedPlan=selectedPlan
      showAnnual=showAnnual
    }}
    <h3>
      Credit card details
    </h3>
    <p data-test-payment-info>
      Your credit card details are never stored or even reach our servers.
      Payment and credit card details are handled by Stripe.
    </p>
    <div class="flex flex--col flex-md-row">
      <div class="full-width form-elem inline-form-elem">
        {{#form.field
          label="Card Number"
          value=cardNumber
          required=true
          showRequiredMark=true
          showValidationStatusIcons=false
          onChange=(action (mut cardNumber)) as |field|
        }}
          {{field.input}}
        {{/form.field}}
      </div>
      <div class="full-width form-elem">
        {{#form.field
          label="Name on Card"
          value=cardName
          required=true
          showRequiredMark=true
          onChange=(action (mut cardName))
          showValidationStatusIcons=false as |field|
        }}
          {{field.input}}
        {{/form.field}}
      </div>
    </div>
    <div class="flex flex--col flex-md-row">
      <div class="flex full-width flex--col flex-md-row">
        <div class="form-elem inline-form-elem">
          {{#form.field
            label="Expiry Date on card"
            value=expiryDateMonth
            showRequiredMark=true
            required=true
            onChange=(action (mut expiryDateMonth))
            showValidationStatusIcons=false as |field|
          }}
            {{#field.select placeholder="Month" options=months as |month|}}
              {{month}}
            {{/field.select}}
          {{/form.field}}
        </div>
        <div class="form-elem billing-select-year">
          {{#form.field
            value=expiryDateYear
            required=true
            showRequiredMark=true
            onChange=(action (mut expiryDateYear))
            showValidationStatusIcons=false as |field|
          }}
            {{#field.select placeholder="Year" options=years as |year|}}
              {{year}}
            {{/field.select}}
          {{/form.field}}
        </div>
      </div>
      <div class="full-width form-elem billing-ccv">
        {{#form.field
          label="cvc"
          value=cvc
          required=true
          showRequiredMark=true
          onChange=(action (mut cvc))
          showValidationStatusIcons=false as |field|
        }}
          {{field.input}}
        {{/form.field}}
      </div>
    </div>
    <h3>
      Discount Code
    </h3>
    <div class="flex flex--col flex-md-row">
      <div class="full-width form-elem inline-form-elem">
        {{#form.field
          label=""
          value=discountCode
          showRequiredMark=true
          required=true
          showValidationStatusIcons=false
          onChange=(action (mut discountCode)) as |field|
        }}
          {{field.input}}
        {{/form.field}}
      </div>
    </div>
    <div class="form-elem">
      {{#if makeStripePayment.isRunning}}
        {{loading-indicator}}
      {{else}}
        <button
          onclick={{form.submit}}
          class="button--blue"
          data-test-subscribe-button
        >
          Complete sign up
        </button>
        <span onclick={{action cancel}} class="billing-process-cancel link">
          Cancel
        </span>
      {{/if}}
    </div>
  </div>
{{/travis-form}}